Test Suite 'AttentionSimilarityBenchmarkTests' started at 2025-12-16 23:16:14.150.
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testAttentionSimilarityScaling]' started.

=== Attention Similarity Scaling (768→64, 100 queries) ===
Keys    | Time (ms)  | Throughput (pairs/s) | Per-query (ms)
--------|------------|----------------------|--------------
    100 |      12.65 |               790575 |         0.126
    500 |      16.29 |              3069931 |         0.163
   1000 |      26.17 |              3821312 |         0.262
   5000 |     111.77 |              4473312 |         1.118
  10000 |     212.86 |              4697931 |         2.129
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testAttentionSimilarityScaling]' passed (5.226 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testMultiHeadAttentionMiniLM]' started.

=== Multi-Head Attention MiniLM (384D, 6 heads) ===
Queries: 100, Keys: 1000
Heads: 6, Head dim: 64
Avg time: 50.04 ms
Throughput: 1998562 pairs/sec
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testMultiHeadAttentionMiniLM]' passed (0.605 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testMultiHeadAttentionTransformer768]' started.

=== Multi-Head Attention (768D, 12 heads) ===
Queries: 100, Keys: 1000
Heads: 12, Head dim: 64
Avg time: 163.02 ms
Throughput: 613416 pairs/sec
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testMultiHeadAttentionTransformer768]' passed (1.865 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testNormalizedVsRawScores]' started.

=== Raw vs Normalized Similarity Scores ===
Raw scores: 27.52 ms
Normalized (sigmoid): 25.71 ms
Overhead: -6.6%
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testNormalizedVsRawScores]' passed (0.642 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testSingleHeadAttentionSimilarity768]' started.

=== Single-Head Attention Similarity (768→64) ===
Queries: 100, Keys: 1000
Total pairs: 100000
Avg time: 24.55 ms
Throughput: 4073520 pairs/sec
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testSingleHeadAttentionSimilarity768]' passed (0.488 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testSingleHeadAttentionSimilarityMiniLM]' started.

=== Single-Head Attention Similarity (384→64 MiniLM) ===
Queries: 100, Keys: 1000
Avg time: 17.83 ms
Throughput: 5609083 pairs/sec
Test Case '-[VectorAccelerateTests.AttentionSimilarityBenchmarkTests testSingleHeadAttentionSimilarityMiniLM]' passed (0.290 seconds).
Test Suite 'AttentionSimilarityBenchmarkTests' passed at 2025-12-16 23:16:23.267.
	 Executed 6 tests, with 0 failures (0 unexpected) in 9.116 (9.117) seconds
Test Suite 'AttentionSimilarityKernelTests' started at 2025-12-16 23:16:23.267.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testComputeWithoutWeights]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testComputeWithoutWeights]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testCustomTemperature]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testCustomTemperature]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testDimensionMismatch]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testDimensionMismatch]' passed (0.003 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testEmptyInput]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testEmptyInput]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testKernelInitialization]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testKernelInitialization]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testLoadWeightsFromArrays]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testLoadWeightsFromArrays]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testMiniLMConfiguration]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testMiniLMConfiguration]' passed (0.004 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testMultiHeadSimilarity]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testMultiHeadSimilarity]' passed (0.012 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testNormalizedSimilarities]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testNormalizedSimilarities]' passed (0.016 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testRandomWeightCreation]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testRandomWeightCreation]' passed (0.007 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testSimilarityLookup]' started.
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testSimilarityLookup]' passed (0.013 seconds).
Test Case '-[VectorAccelerateTests.AttentionSimilarityKernelTests testSimilarityPerformance]' started.
Attention Similarity Performance:
  Queries: 100, Keys: 1000
  Input dimension: 768
  Head dimension: 64
