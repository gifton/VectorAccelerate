Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKEquals32WarpOptimized]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKEquals32WarpOptimized]' passed (0.012 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKEquals50StandardFallback]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKEquals50StandardFallback]' passed (0.014 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKGreaterThan8MatchesCPUReference]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testKGreaterThan8MatchesCPUReference]' passed (0.010 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testMaxDimension]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testMaxDimension]' passed (0.010 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testMultipleQueries]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testMultipleQueries]' passed (0.008 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationDimensionTooLarge]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationDimensionTooLarge]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationKTooLarge]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationKTooLarge]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationSuccess]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationSuccess]' passed (0.001 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationZeroValues]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testParametersValidationZeroValues]' passed (0.001 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testWithoutDistancesK16]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testWithoutDistancesK16]' passed (0.009 seconds).
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testWithoutDistances]' started.
Test Case '-[VectorAccelerateTests.FusedL2TopKKernelTests testWithoutDistances]' passed (0.008 seconds).
Test Suite 'FusedL2TopKKernelTests' passed at 2025-12-16 23:16:25.188.
	 Executed 17 tests, with 0 failures (0 unexpected) in 0.151 (0.154) seconds
Test Suite 'GPUCandidateBuilderValidationTests' started at 2025-12-16 23:16:25.188.
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testGPUCandidateBuilderKernelDirectly]' started.

======================================================================
Direct GPU Candidate Builder Kernel Test
======================================================================

Results:
  Total candidates: 30
  Expected: 30 (18 + 12)

CSR Offsets: [0, 18, 30]
  Query 0 range: 0..<18 (count: 18)
  Query 1 range: 18..<30 (count: 12)

âœ“ GPU Candidate Builder produces correct candidate counts
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testGPUCandidateBuilderKernelDirectly]' passed (0.061 seconds).
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testGPUvsCPUCandidateBuildingEquivalence]' started.

======================================================================
GPU vs CPU Candidate Building Comparison
======================================================================

--- Testing with GPU Candidate Builder (default) ---
GPU Candidate Builder Recall: 56.0%

----------------------------------------------------------------------
GPU Candidate Builder Result:
  Recall: 56.0%
  Expected range for nprobe=4/nlist=16 (25%): 50-80%
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testGPUvsCPUCandidateBuildingEquivalence]' passed (0.511 seconds).
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testRecallVsNprobeWithRandomQueries]' started.

======================================================================
Recall vs nprobe (Truly Random Queries)
======================================================================

| nprobe | % clusters | Recall (GPU) | Expected |
|--------|------------|--------------|----------|
|      1 |         3% |        13.1% | ~30%     |
|      2 |         6% |        19.2% | ~50%     |
|      4 |        12% |        39.3% | ~65%     |
|      8 |        25% |        57.8% | ~80%     |
|     16 |        50% |        78.4% | ~90%     |
|     32 |       100% |       100.0% | ~100%    |
----------------------------------------------------------------------
Note: With truly random queries, recall should scale with nprobe/nlist
Test Case '-[VectorAccelerateTests.GPUCandidateBuilderValidationTests testRecallVsNprobeWithRandomQueries]' passed (75.493 seconds).
Test Suite 'GPUCandidateBuilderValidationTests' passed at 2025-12-16 23:17:41.254.
	 Executed 3 tests, with 0 failures (0 unexpected) in 76.065 (76.066) seconds
Test Suite 'HammingDistanceKernelTests' started at 2025-12-16 23:17:41.254.
Test Case '-[VectorAccelerateTests.HammingDistanceKernelTests testCompletelyDifferentVectors]' started.
Test Case '-[VectorAccelerateTests.HammingDistanceKernelTests testCompletelyDifferentVectors]' passed (0.031 seconds).
Test Case '-[VectorAccelerateTests.HammingDistanceKernelTests testDistanceMatrix]' started.
Test Case '-[VectorAccelerateTests.HammingDistanceKernelTests testDistanceMatrix]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.HammingDistanceKernelTests testFusibleWith]' started.
