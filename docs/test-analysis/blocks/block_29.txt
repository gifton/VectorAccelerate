  gpu_reduce_centroids: 2-3x speedup for centroid updates
Test Case '-[VectorAccelerateTests.OptimizedKernelsTests testOptimizationBenefits]' passed (0.000 seconds).
Test Case '-[VectorAccelerateTests.OptimizedKernelsTests testTilingStrategy]' started.

Tiling parameters for optimal Apple Silicon performance:
  TILE_SIZE_C = 8
  TILE_SIZE_Q = 32
  TILE_DIM = 32
Test Case '-[VectorAccelerateTests.OptimizedKernelsTests testTilingStrategy]' passed (0.000 seconds).
Test Suite 'OptimizedKernelsTests' passed at 2025-12-16 23:22:40.080.
	 Executed 4 tests, with 0 failures (0 unexpected) in 0.002 (0.002) seconds
Test Suite 'ParallelReductionKernelTests' started at 2025-12-16 23:22:40.081.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testArgMax]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testArgMax]' passed (0.005 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testArgMin]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testArgMin]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testComputeStatistics]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testComputeStatistics]' passed (0.006 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMaximum]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMaximum]' passed (0.002 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMinimum]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMinimum]' passed (0.004 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMixedValues]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testMixedValues]' passed (0.003 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testNegativeValues]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testNegativeValues]' passed (0.006 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSingleElement]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSingleElement]' passed (0.010 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSumLargeArray]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSumLargeArray]' passed (0.007 seconds).
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSum]' started.
Test Case '-[VectorAccelerateTests.ParallelReductionKernelTests testSum]' passed (0.003 seconds).
Test Suite 'ParallelReductionKernelTests' passed at 2025-12-16 23:22:40.130.
	 Executed 10 tests, with 0 failures (0 unexpected) in 0.047 (0.049) seconds
Test Suite 'PerformanceBenchmarks' started at 2025-12-16 23:22:40.130.
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testBatchInsertPerformance]' started.

=== Batch Insert Benchmark (1000 vectors, 128D) ===
Time: 0.438ms
Throughput: 2283236 vectors/sec
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testBatchInsertPerformance]' passed (0.044 seconds).
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testBenchmarkSummary]' started.


╔══════════════════════════════════════════════════════════════╗
║        VectorAccelerate Performance Benchmarks        ║
╠══════════════════════════════════════════════════════════════╣
║ Dim 128: Insert 22643 vec/s | Search   0.60ms ║
║ Dim 768: Insert  3965 vec/s | Search   0.85ms ║
║ IVF (nlist=8, nprobe=2):                   Search   0.21ms ║
╚══════════════════════════════════════════════════════════════╝

Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testBenchmarkSummary]' passed (1.602 seconds).
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testFlatSearch10K_128D]' started.
Inserting 10000 vectors...
Insert time: 0.41s (24169 vectors/sec)

=== Flat Search Benchmark (10K vectors, 128D) ===
Average: 0.690ms
Median: 0.621ms
QPS: 1449
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testFlatSearch10K_128D]' passed (0.492 seconds).
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testFlatSearch10K_768D]' started.
Inserting 10000 vectors (dim=768)...
Insert time: 2.41s

=== Flat Search Benchmark (10K vectors, 768D) ===
Average: 0.821ms
Median: 0.829ms
QPS: 1217
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testFlatSearch10K_768D]' passed (2.462 seconds).
Test Case '-[VectorAccelerateTests.PerformanceBenchmarks testIVFSearch10K_128D]' started.
Inserting 10000 vectors into IVF...
Insert time: 10.03s

=== IVF Search Benchmark (10K vectors, 128D, nlist=32, nprobe=4) ===
Average: 0.893ms
Median: 0.838ms
QPS: 1120
